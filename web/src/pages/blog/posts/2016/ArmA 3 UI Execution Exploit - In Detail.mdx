<strong>EDIT: </strong>The latest patch (0.66) has fixed these issues. This post should now be used to learn how to better prevent these forms of exploits from appearing in your missions and mods.

Now that BI has fixed the issue in its latest Dev Patch I wanted to go over, <strong>in detail</strong>, how this method works, and how we all can work to prevent these types of flaws from happening again.

&nbsp;
<!--nextpage-->
<hr />

<h2 style="text-align: center;">What is this bug?</h2>
This is a <em>code execution exploit</em>. What I mean by that is: <strong>It allows cheaters to execute SQF code from inside ArmA. This means they can run any scripts on your server without BattlEye interfering with them.<em>
</em></strong>
Why is this bad? It allows your server to be cheated on. Plain and simple. BattlEye can do nothing about this. You may wonder, why doesn't BE just ban people for using this? The answer to that is quite simple as well. <strong>If BattlEye were to ban for this, they could subject any user to a false ban.</strong> You may have felt the effects of a <em>Remote Execution</em> or as it really should be dubbed <em>Remote Code Execution</em> on your server. If your server has ever been attacked where the hacker can: kill everyone, spawn a nuke, start a thunder dome, steal your server files or other extreme exploits of such nature, you have hadÂ  a hacker with a <em>Remote Execution</em> on your server. If someone were to run the "Injection Code" on every player on your server, how could Battleye know who the actual cheater is and who the good guys are? It simply can't. It can not determine who is abusing the injection and who happened to have it run on them via <em>Remote Execution</em>. This is why BattlEye can not ban for this.

&nbsp;
<!--nextpage-->
<hr />

<h2 style="text-align: center;">What causes this bug?</h2>
There are actually two causes to this bug. Both stem from UI Code Execution. They both abuse BIS_fnc_parseNumber.

<strong>BIS_fnc_parseNumber</strong>
The problem in this regard is how parseNumber works. When it detects a string being passed into it, instead of using the <em>parseNumber</em> command, it uses <em>call compile</em>. Basically, instead of using a new feature in the game, BI never edited this file, leaving it open to code execution via the <em>call compile</em> commands. This fix is relatively simple for BI. The variables <strong>igui_bcg_rgb_a, igui_bcg_rgb_r, igui_bcg_rgb_g, and igui_bcg_rgb_b</strong> all use BIS_fnc_parseNumber if they contain a string value. This is how the cheater executes code. They simple set one of these values to their script and end it with a number.
For Example: <strong>profileNamespace setVariable ["igui_bcg_rgb_a","hint 'run code';0.4"];</strong>

<strong>Customizable UI layout
</strong>The script executed by the customizable layout UI is this:
<img class="alignnone" src="https://gyazo.com/1d7452332e73d27f6508287684aa9e56.png" width="862" height="379" />
<img class="alignnone" src="https://gyazo.com/84bba05d5af5ebbece6cd5587e4e2790.png" width="825" height="328" />
The problem with this is that for each variable if it contains a string it will use <strong>BIS_fnc_parseNumber</strong> to get a number from it. This has the same effects as above, just in a different context.
With this, the <em>_presetName</em> must = "". In order to do this, the cheater must also change the preset variable that is passed into the the UI function as shown below.
<img class="alignnone" src="https://gyazo.com/3302b8f44bbcfb706354dded04646eb0.png" width="766" height="136" />

Here is how I went about doing that:<img class="alignnone" src="https://i.gyazo.com/7e255534a4f991e15c2949d550fdcb88.png" width="1265" height="613" />

<img class="alignnone" src="https://i.gyazo.com/7751353cea20686ca4865c7ce6392daf.png" width="1212" height="536" />

<img class="alignnone" src="https://i.gyazo.com/7d7dd64a2717e5cc3342633e989ae11b.png" width="1027" height="193" />

This will set the preset to an empty string ("") and inject the code that is to be executed into <strong>IGUI_grid_mission_X</strong>. Essentially, bypassing any needed input from the person using it.
<!--nextpage-->
<hr />

<h1 style="text-align: center;">How to patch this on your server / mod</h1>

<hr />

<h2 style="text-align: center;">If you create a mod</h2>
<strong>BIS_fnc_parseNumber fix
</strong>You need to override parseNumber. As of now, I have not looked into the new patch BI released, however overriding parse number will be the fix for your mod on the current patch.

In your config file for functions, You need to add this.
<img class="alignnone" src="https://i.gyazo.com/630400cee4505fab24167130f8b57113.png" width="899" height="418" />
Not word for word of course, but override <em>ConfigFile &gt;&gt; "CfgFunctions" &gt;&gt; "A2" &gt;&gt; "Numbers" &gt;&gt; "parseNumber"</em> with your own function.

Now your <em>parseNumber.sqf</em> should be changed. Here is the change.

[caption id="" align="alignnone" width="639"]<img class="" src="https://i.gyazo.com/50973a8a8675e455b44330c31aa93129.png" width="639" height="521" /> Original BIS_fnc_parseNumber[/caption]

[caption id="" align="alignnone" width="626"]<img class="" src="https://gyazo.com/659c68371b70d065512d37390359ae0f.png" width="626" height="731" /> New BIS_fnc_parseNumber (it is embarrassing how much I've edited this) (thanks torndeco for pointing out flaws)[/caption]

This fix is only a "temporary" workaround, sure the code could be executed using a more complex method than what my example was, but this will patch the current execution exploits out there. This removes all the "code" leading up to the number, removing any malicious

&nbsp;

<hr />

<h2 style="text-align: center;">If you run your own server</h2>
If you run your own server, this fix is "simpler" however less <em>effective</em> in a sense. You can still patch the bug. However, you can not "prevent" the bug (Ie. You can not stop the bug at its source).

<strong>ProfileNamespace fix</strong>

As I showed in my previous post, You need to have the profileNamespace fix. This will need to be in your client code until the next BI patch comes along.
<img class="alignnone" src="https://gyazo.com/b6065a8b456b878db4b4771c0e25ed86.png" width="762" height="171" />

This profileNamespace fix WILL patch the bug. However, it does not prevent the bug. You will have to wait for BI to push their next patch to remove this code.